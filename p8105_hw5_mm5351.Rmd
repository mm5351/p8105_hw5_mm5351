---
title: "p8105_hw5_mm5351"
author: "Martha Mulugeta"
date: "11/6/2019"
output: github_document
---

**Problem 1**
```{r setup, include=FALSE}
knitr::opts_chunk$set(echo = TRUE)

library(tidyverse)

set.seed(10)

iris_with_missing = iris %>% 
  map_df(~replace(.x, sample(1:150, 20), NA)) %>%
  mutate(Species = as.character(Species))
```

```{r}
iris_fill = function(x) {
  if (is.numeric(x)) {
    replace_na(x, mean(x, na.rm = TRUE))
  } else if (is.character(x)) {
    replace_na(x, "virginica")
  }
}

output = map_df(iris_with_missing, iris_fill) 
```

list.files(path = "./Data", pattern = ".csv",  all.files = TRUE)

**Problem 2**
```{r}
study_df = tibble(
participants = list.files(path = "./Data", pattern = ".csv",  all.files = TRUE, full.names = TRUE)) %>% 
  mutate(data = map(participants, read_csv)) %>% 
  unnest() 

study_df = 
  study_df %>%
  separate(col = participants, sep = "_", into = c("arm", "subjectID")) %>% 
  mutate(
    arm = str_replace(arm, "./Data/", ""),
    subjectID = str_replace(subjectID, ".csv", "")
  )
```

```{r}
study_df %>% 
  pivot_longer(
    week_1:week_8,
    names_to = "week",
    values_to = "observation"
  ) %>% 
  
ggplot(aes(x = week, y = observation, group = subjectID, color = arm)) +
  geom_line() + 
     labs(
    title = "Observations Over Time",
    x = "Time (Week)",
    y = "Observation")
```

**Problem 3**
```{r}
sim_regression = function(n = 30, beta0 = 2, beta1 = 0) {
   sim_data = tibble(
    x = rnorm(n, mean = 0, sd = sqrt(50)),
    y = beta0 + beta1 * x + rnorm(n, 0, sqrt(50))
  )
  
  ls_fit = lm(y ~ x, data = sim_data)
  
  tibble(
    beta0_hat = coef(ls_fit)[1],
    beta1_hat = coef(ls_fit)[2]
  )
}
```

